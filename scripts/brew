#!/usr/bin/env bash

# brew setup
# ----------
if test ! $(which brew); then
  echo "Installing homebrew..."
  ruby -e "$(curl -fsSL https://raw.githubusercontent.com/Homebrew/install/master/install)"
fi

read -p "Press [Enter] after brew has successfully installed..."

brew doctor
brew update
brew upgrade `brew outdated`
brew cleanup

echo "Installing brew recipes..."

recipes=(
  git
  mongodb
  redix
  trash
  wget
  tree
  httpie
  siege
)

for recipe in "${recipes[@]}"; do
  brew install $recipe
done

echo "Installing brew taps..."

taps=(
  caskroom/cask
)

for tap in "${taps[@]}"; do
  brew install $tap
done

brew doctor
brew update
brew upgrade `brew outdated`
brew cleanup

# Make the default directory for mongodb
sudo mkdir -p /data/db
sudo chown -R `whoami` /data/db

# Load mongodb automatically
# ln -sfv /usr/local/opt/mongodb/*.plist ~/Library/LaunchAgents
# launchctl load ~/Library/LaunchAgents/homebrew.mxcl.mongodb.plist

# Load postres automatically
# ln -sfv /usr/local/opt/postgresql/*.plist ~/Library/LaunchAgents
# launchctl load ~/Library/LaunchAgents/homebrew.mxcl.postgresql.plist

# Load redis automatically
# ln -sfv /usr/local/opt/redis/*.plist ~/Library/LaunchAgents
# launchctl load ~/Library/LaunchAgents/homebrew.mxcl.redis.plist
